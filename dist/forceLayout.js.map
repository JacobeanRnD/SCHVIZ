{"version":3,"sources":["layout.coffee"],"names":[],"mappings":"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","file":"forceLayout.js","sourceRoot":"/source/","sourcesContent":["force = window.forceLayout = {}\n\nKIELER_URL = 'http://kieler.herokuapp.com/live'\nMARGIN = 5\nROUND_CORNER = 5\nCELL_MIN = {w: 40, h: 40}\nCELL_PAD = {top: 20, bottom: 5, left: 5, right: 5}\nLABEL_SPACE = 400\nCONTROL_SIZE = {w: 25, h: 25}\nLINK_STRENGTH = .1\nLINK_DISTANCE = 30\nDEBUG_FORCE_FACTOR = 50\nMIN_ZOOM = 1/6\nMAX_ZOOM = 6\nANIMATION_SPEED = 2\n\n\nstrip = (obj) ->\n  for key, value of obj\n    if value?\n      if _.isArray(value) and value.length == 0\n        delete obj[key]\n      else if _.isObject(value)\n        strip(value)\n        if _.isEmpty(value)\n          delete obj[key]\n    else\n      delete obj[key]\n  return obj\n\n\ntreeFromXml = (doc) ->\n  parseActions = (container) ->\n    rv = []\n    for child in container.childNodes\n      if child.tagName\n        rv.push(xml: '' + child)\n    return rv\n\n  parseChildNodes = (node) ->\n    transitions = []\n    onentry = []\n    onexit = []\n\n    for child in node.childNodes\n      switch child.tagName\n        when 'transition'\n          target = child.getAttribute('target')\n          unless target\n            throw new Error(\"not implemented: transition with no target\")\n          if target.indexOf(' ') > -1\n            throw new Error(\"not implemented: transition with multiple targets\")\n          transitions.push(strip(\n            target: target\n            cond: child.getAttribute('cond') or null\n            event: child.getAttribute('event') or null\n            actions: parseActions(child)\n          ))\n\n        when 'onentry'\n          onentry = onentry.concat(parseActions(child))\n\n        when 'onexit'\n          onexit = onexit.concat(parseActions(child))\n\n    return {\n      transitions: transitions\n      onentry: onentry\n      onexit: onexit\n    }\n\n  parseStates = (node) ->\n    stateList = []\n    for node in node.childNodes\n      state = switch node.tagName\n        when 'initial'\n          {\n            type: 'initial'\n            id: node.getAttribute('id') or null\n            children: parseStates(node)\n          }\n\n        when 'state'\n          {\n            type: 'state'\n            id: node.getAttribute('id') or null\n            children: parseStates(node)\n          }\n\n        when 'final'\n          {\n            type: 'final'\n            id: node.getAttribute('id') or null\n            children: parseStates(node)\n          }\n\n        when 'parallel'\n          {\n            type: 'parallel'\n            id: node.getAttribute('id') or null\n            children: parseStates(node)\n          }\n\n        when 'history'\n          {\n            type: 'history'\n            id: node.getAttribute('id') or null\n            deep: node.getAttribute('type') == 'deep' or null\n          }\n\n      if state?\n        _.extend(state, parseChildNodes(node))\n        stateList.push(strip(state))\n\n    return stateList\n\n  return {sc: parseStates(doc.documentElement)}\n\n\nidMaker = ->\n  counterMap = d3.map()\n  return (prefix='_force_id_') ->\n    counter = counterMap.get(prefix) or 0\n    counter += 1\n    counterMap.set(prefix, counter)\n    return \"#{prefix}#{counter}\"\n\n\nnextId = idMaker()\n\n\ndef = (map, key, defaultValue) ->\n  unless map.has(key)\n    map.set(key, defaultValue)\n  return map.get(key)\n\n\nwalk = (node, callback, parent=null, postorder=false) ->\n  callback(node, parent) unless postorder\n  for child in node.children or []\n    walk(child, callback, node, postorder)\n  callback(node, parent) if postorder\n\n\nparents = (node) ->\n  if node.parent then parents(node.parent).concat([node.parent]) else []\n\n\npath = (node1, node2) ->\n  parents1 = parents(node1)\n  parents2 = parents(node2)\n  eq = 0\n  for n in [0 .. d3.min([parents1.length, parents2.length]) - 1]\n    if parents1[n] != parents2[n] then break\n    eq = n\n  return [node1, parents1[eq], node2]\n\n\nexit = (cell, point) ->\n  d = {x: point.x - cell.x, y: point.y - cell.y}\n  ex = cell.w / 2 / d.x\n  ey = cell.h / 2 / d.y\n  e = d3.min([ex, ey], Math.abs)\n  return {x: cell.x + d.x * e, y: cell.y + d.y * e}\n\n\nmidpoint = (a, b) -> {\n  x: ((a.x or 0) + (b.x or 0)) / 2\n  y: ((a.y or 0) + (b.y or 0)) / 2\n}\n\n\ntransitionPath = (tr) ->\n  [a, b, c] = [tr.a, tr.b, tr]\n\n  if tr.selfie\n    w = c.x - a.x\n    h = c.y - a.y\n    c1 = {x: c.x - h/4, y: c.y + w/4}\n    c2 = {x: c.x + h/4, y: c.y - w/4}\n    s = exit(a, c1)\n    t = exit(a, c2)\n    return \"M#{s.x},#{s.y}\n            C#{c1.x},#{c1.y}\n             #{c1.x},#{c1.y}\n             #{c.x},#{c.y}\n            C#{c2.x},#{c2.y}\n             #{c2.x},#{c2.y}\n             #{t.x},#{t.y}\"\n\n  else\n    s = exit(a, c)\n    t = exit(b, c)\n    m = midpoint(c, midpoint(s, t))\n    d = {x: c.x - m.x, y: c.y - m.y}\n    sm = midpoint(s, m)\n    tm = midpoint(t, m)\n    i = sc = {x: sm.x + d.x, y: sm.y + d.y}\n    j = tc = {x: tm.x + d.x, y: tm.y + d.y}\n    return \"M#{s.x},#{s.y}\n            S#{i.x},#{i.y}\n             #{c.x},#{c.y}\n            S#{j.x},#{j.y}\n             #{t.x},#{t.y}\"\n\n\nfindTransition = (transitions, source, target) ->\n  for tr in transitions\n    if tr.a.id == source and tr.b.id == target\n      return tr\n\n\ntoKielerFormat = (node) ->\n  children = []\n  edges = []\n  for child in node.children or []\n    children.push(toKielerFormat(child))\n    for transition in child.transitions or []\n      edges.push(\n        id: transition.id\n        source: child.id\n        target: transition.target\n      )\n  rv = {\n    id: node.id\n    children: children\n    edges: edges\n  }\n  if node.id?\n    rv.labels = [{text: node.id}]\n  if (node.children or []).length == 0\n    rv.width = node.w\n    rv.height = node.h\n  return rv\n\n\nforce.kielerLayout = (kielerAlgorithm, top) ->\n  edgeMap = d3.map()\n\n  applyLayout = (node, kNode, x0 = null, y0 = null) ->\n    node.w = kNode.width\n    node.h = kNode.height\n\n    unless x0? and y0?\n      x0 = -node.w/2\n      y0 = -node.h/2\n\n    node.x = x0 + kNode.x + node.w/2\n    node.y = y0 + kNode.y + node.h/2\n\n    for tr in node.transitions or []\n      edge = edgeMap.get(tr.id)\n      if edge.bendPoints.length\n        points = edge.bendPoints\n      else\n        points = [edge.sourcePoint, edge.targetPoint]\n      tr.x = x0 + d3.mean(points, (p) -> p.x)\n      tr.y = y0 + d3.mean(points, (p) -> p.y)\n\n    childMap = d3.map()\n    for child in node.children or []\n      if child.id? then childMap.set(child.id, child)\n\n    for kChild in kNode.children or []\n      unless (child = childMap.get(kChild.id))? then continue\n      applyLayout(child, kChild, node.x - node.w/2, node.y - node.h/2)\n\n  graph = toKielerFormat(top)\n\n  form = {\n    graph: JSON.stringify(graph)\n    config: JSON.stringify(\n      algorithm: kielerAlgorithm\n    )\n    iFormat: 'org.json'\n    oFormat: 'org.json'\n  }\n\n  return Q($.post(KIELER_URL, form))\n    .then (resp) ->\n      graphLayout = JSON.parse(resp)[0]\n      walk graphLayout, (kNode) =>\n        for edge in kNode.edges or []\n          edgeMap.set(edge.id, edge)\n      applyLayout(top, graphLayout)\n    .catch (resp) ->\n      throw Error(resp.responseText)\n\n\nclass NewNodesAnimation\n\n  constructor: (@newNodes) ->\n    @deferred = Q.defer()\n    @promise = @deferred.promise\n    @done = no\n    @targetMap = d3.map()\n    @abort() unless @newNodes.length > 0\n\n    for node in @newNodes\n      @targetMap.set(node.id, {w: node.w, h: node.h})\n      node.w = node.h = 5\n\n  tick: ->\n    return if @done\n    changed = no\n    for node in @newNodes\n      target = @targetMap.get(node.id)\n      (node.w += ANIMATION_SPEED; changed = yes) if node.w < target.w\n      (node.h += ANIMATION_SPEED; changed = yes) if node.h < target.h\n\n    @abort() unless changed\n\n  abort: ->\n    @done = yes\n    @deferred.resolve()\n\n\nclass LoadingOverlay\n\n  constructor: (options) ->\n    w = $(options.svg).width()\n    h = $(options.svg).height()\n    @el = d3.select(options.svg).append('g')\n        .attr('class', \"loadingOverlay\")\n    @el.append('rect')\n        .attr('width', w)\n        .attr('height', h)\n    @el.append('text')\n        .attr('x', w/2)\n        .attr('y', h/2)\n        .text(options.text)\n\n  destroy: ->\n    @el.remove()\n\n\nclass force.Layout\n\n  constructor: (options) ->\n    @queue = async.queue(((task, cb) -> task(cb)), 1)\n    @options = options\n    @debug = options.debug or false\n    @svgCreate(options.parent)\n    @runSimulation = false\n    @s = @_emptyState()\n    @animation = new NewNodesAnimation([])\n    @_initialTree(options.tree or treeFromXml(options.doc).sc)\n\n  _initialTree: (tree) ->\n    deferred = Q.defer()\n    @initialized = deferred.promise\n\n    @queue.push (cb) =>\n      @loadTree(tree)\n\n      if @options.geometry?\n        @applyGeometry(@options.geometry)\n        @beginSimulation()\n        cb()\n        deferred.resolve()\n\n      else\n        loading = new LoadingOverlay(svg: @el, text: \"Loading Kieler layout ...\")\n        deferred.resolve(\n          force.kielerLayout(@options.kielerAlgorithm, @s.top)\n            .then (treeWithLayout) =>\n              loading.destroy()\n              @beginSimulation()\n              cb()\n        )\n\n  update: (doc) ->\n    deferred = Q.defer()\n    @queue.push (cb) =>\n      deferred.resolve(\n        Q()\n        .then =>\n          @loadTree(treeFromXml(doc).sc)\n        .then =>\n          @beginSimulation()\n          @s.newNodes = [] unless @runSimulation\n        .then =>\n          @animation = new NewNodesAnimation(@s.newNodes)\n          return @animation.promise\n        .catch (e) =>\n          console.error e\n        .finally =>\n          cb()\n      )\n\n    return deferred.promise\n\n  _emptyState: -> {\n      nodes: []\n      cells: []\n      nodeMap: d3.map()\n      links: []\n      transitions: []\n      top: {\n        children: []\n        controls: []\n      }\n      newNodes: []\n      dom: d3.map()\n    }\n\n  loadTree: (tree) ->\n    @mergeTree(tree)\n    @svgNodes()\n\n  beginSimulation: ->\n    @setupD3Layout()\n    @layout.on 'tick', =>\n      @adjustLayout()\n      @svgUpdate()\n      @animation.tick()\n    @svgUpdate()\n\n  mergeTree: (tree) ->\n    oldS = @s\n    newS = @_emptyState()\n    newS.top.children = tree\n\n    makeId = idMaker()\n\n    for topNode in tree\n      walk topNode, (node, parent) =>\n        node.controls = []\n        node.children = node.children or []\n        if (oldNode = oldS.nodeMap.get(node.id))?\n          node.x = oldNode.x\n          node.y = oldNode.y\n          node.w = oldNode.w\n          node.h = oldNode.h\n        else\n          node.w = CELL_MIN.w\n          node.h = CELL_MIN.h\n          if parent?\n            node.x = parent.x\n            node.y = parent.y\n          newS.newNodes.push(node)\n        newS.nodes.push(node)\n        newS.cells.push(node)\n        newS.nodeMap.set(node.id, node)\n        node.parent = if parent? then newS.nodeMap.get(parent.id) else newS.top\n\n    for topNode in tree\n      walk topNode, (node) =>\n        for tr in node.transitions or []\n          unless (target = newS.nodeMap.get(tr.target))?\n            throw Error(\"missing transition target: #{tr.target}\")\n          [a, c, b] = path(node, target)\n          tr.parent = c or newS.top\n          tr.w = CONTROL_SIZE.w\n          tr.h = CONTROL_SIZE.h\n          tr.id = tr.id or makeId(\"_transition/#{node.id}/#{target.id}/\")\n          newS.nodeMap.set(tr.id, tr)\n          tr.parent.controls.push(tr)\n          newS.nodes.push(tr)\n          for [link_source, link_target] in d3.pairs([a, tr, b])\n            newS.links.push(\n              source: link_source\n              target: link_target\n            )\n          label = tr.event or ''\n          tr.a = a\n          tr.b = b\n          tr.selfie = node.id == tr.target\n          tr.label = label\n          newS.transitions.push(tr)\n          if (oldTr = findTransition(oldS.transitions, tr.a.id, tr.b.id))?\n            _.extend(tr, {x: oldTr.x, y: oldTr.y})\n          else\n            _.extend(tr, midpoint(tr.a, tr.b))\n\n    @layout.stop() if @layout\n    @s = newS\n\n  saveGeometry: ->\n    round = (x) -> Math.round(x)\n    return JSON.stringify({\n      nodes: {\n        id: n.id\n        w: round(n.w)\n        h: round(n.h)\n        x: round(n.x)\n        y: round(n.y)\n      } for n in @s.nodes\n    })\n\n  applyGeometry: (geom) ->\n    for saved in JSON.parse(geom).nodes\n      if (node = @s.nodeMap.get(saved.id))?\n        node.w = saved.w\n        node.h = saved.h\n        node.px = node.x = saved.x\n        node.py = node.y = saved.y\n    @svgUpdate()\n    @layout.start() if @layout and @runSimulation\n\n  svgCreate: (parent) ->\n    width = $(parent).width() - 5\n    height = $(parent).height() - 5\n\n    zoom = d3.behavior.zoom()\n        .scaleExtent([MIN_ZOOM, MAX_ZOOM])\n\n    svg = d3.select(parent).append('svg')\n        .classed('force-layout', true)\n        .classed('debug', @debug)\n    @el = svg[0][0]\n    defs = svg.append('defs')\n    zoomNode = svg.append('g')\n    @container = zoomNode.call(zoom).append('g')\n    zoomRect = @container.append('rect')\n        .attr('class', 'zoomRect')\n\n    svg.attr('width', width).attr('height', height)\n\n    zoomRect\n        .attr('width', width / MIN_ZOOM)\n        .attr('height', height / MIN_ZOOM)\n        .attr('x', - width / 2 / MIN_ZOOM)\n        .attr('y', - height / 2 / MIN_ZOOM)\n\n    zoom.on 'zoom', =>\n        e = d3.event\n        @container.attr('transform', \"translate(#{e.translate}),scale(#{e.scale})\")\n\n    zoom.size([width, height])\n        .translate([width / 2, height / 2])\n        .event(zoomNode)\n\n    defs.append('marker')\n        .attr('id', (@_arrow_id = nextId()))\n        .attr('refX', '7')\n        .attr('refY', '5')\n        .attr('markerWidth', '10')\n        .attr('markerHeight', '10')\n        .attr('orient', 'auto')\n      .append('path')\n        .attr('d', 'M 0 0 L 10 5 L 0 10 z')\n        .attr('class', 'arrow')\n\n  svgNodes: ->\n    @container.selectAll('.cell').remove()\n    @container.selectAll('.transition').remove()\n    @container.selectAll('.transition-label').remove()\n\n    cell = @container.selectAll('.cell')\n        .data(@s.cells)\n      .enter().append('g')\n        .attr('class', (cell) -> \"cell cell-#{cell.type or 'state'} draggable\")\n        .classed('parallel-child', (cell) -> cell.parent.type == 'parallel')\n\n    cell.append('rect')\n        .attr('class', 'border')\n        .attr('rx', ROUND_CORNER)\n        .attr('ry', ROUND_CORNER)\n\n    cell.append('text')\n        .text((node) -> node.id)\n        .each (node) ->\n          node.textWidth = d3.min([$(@).width() + 2 * ROUND_CORNER, LABEL_SPACE])\n          node.w = d3.max([node.w, node.textWidth])\n\n    @container.selectAll('.transition')\n        .data(@s.transitions)\n      .enter().append('g')\n        .attr('class', 'transition')\n      .append('path')\n        .attr('style', \"marker-end: url(##{@_arrow_id})\")\n\n    @container.selectAll('.transition-label')\n        .data(@s.transitions)\n      .enter().append('g')\n        .attr('class', 'transition-label draggable')\n      .append('text')\n        .text((tr) -> tr.label)\n        .each (tr) ->\n          tr.textWidth = d3.min([$(@).width() + 5, LABEL_SPACE])\n          tr.w = d3.max([tr.w, tr.textWidth])\n        .attr('dy', '.3em')\n\n    @container.selectAll('.transition-label').append('rect')\n        .attr('x', (tr) -> -tr.w / 2)\n        .attr('y', (tr) -> -tr.h / 2)\n        .attr('width', (tr) -> tr.w)\n        .attr('height', (tr) -> tr.h)\n\n    dom = @s.dom\n\n    @container.selectAll('.cell')\n        .each (node) ->\n          dom.set(\"cell-#{node.id}\", @)\n\n    @container.selectAll('.transition')\n        .each (node) ->\n          dom.set(\"transition-#{node.id}\", @)\n\n  svgUpdate: ->\n    @container.selectAll('.cell')\n        .attr('transform', (node) -> \"translate(#{node.x},#{node.y})\")\n        .classed('fixed', (node) -> node.fixed)\n\n    @container.selectAll('.cell').each (node) ->\n        d3.select(this).select('rect')\n            .attr('x', - node.w / 2)\n            .attr('y', - node.h / 2)\n            .attr('width', node.w)\n            .attr('height', node.h)\n\n        d3.select(this).select('text')\n            .attr('y', (node) -> CELL_PAD.top - node.h / 2 - 5)\n\n    @container.selectAll('.selfie').remove()\n\n    @container.selectAll('.transition').selectAll('path')\n        .attr 'd', transitionPath\n\n    @container.selectAll('.transition-label')\n        .attr('transform', (tr) -> \"translate(#{tr.x},#{tr.y})\")\n\n  setupD3Layout: ->\n    @layout = d3.layout.force()\n        .charge(0)\n        .gravity(0)\n        .linkStrength(LINK_STRENGTH)\n        .linkDistance(LINK_DISTANCE)\n        .nodes(@s.nodes)\n        .links(@s.links)\n        .start()\n\n    @layout.stop() unless @runSimulation\n\n    lock = {node: null, drag: false}\n\n    drag = d3.behavior.drag()\n        .origin((node) -> node)\n        .on 'dragstart', (node) =>\n          d3.event.sourceEvent.stopPropagation()\n          (lock.node = node).fixed = true\n          lock.drag = true\n        .on 'drag', (node) =>\n          d3.event.sourceEvent.stopPropagation()\n          node.px = d3.event.x\n          node.py = d3.event.y\n          if @runSimulation\n            @layout.resume()\n          else\n            node.x = node.px\n            node.y = node.py\n            @adjustLayout()\n            @svgUpdate()\n        .on 'dragend', (node) =>\n          d3.event.sourceEvent.stopPropagation()\n          lock.drag = false\n          lock.node = null\n          node.fixed = false\n\n    @container.selectAll('.draggable')\n        .on 'mouseover', (node) =>\n          if lock.drag then return\n          if lock.node then lock.node.fixed = false\n          (lock.node = node).fixed = true\n          node.px = node.x\n          node.py = node.y\n          @svgUpdate()\n        .on 'mouseout', (node) =>\n          if lock.drag then return\n          lock.node = null\n          node.fixed = false\n          @svgUpdate()\n        .call(drag)\n\n  adjustLayout: ->\n    tick = {\n      gravity: @layout.alpha() * 0.1\n      forces: d3.map()\n    }\n\n    move = (node, dx, dy) ->\n      node.x += dx\n      node.y += dy\n      for child in node.children or []\n        move(child, dx, dy)\n      for control in node.controls or []\n        move(control, dx, dy)\n\n\n    handleCollisions = (parent, center, tick) =>\n      for child in parent.children\n        dx = (center.x - child.x) * tick.gravity\n        dy = (center.y - child.y) * tick.gravity\n        move(child, dx, dy)\n        def(tick.forces, child.id, []).push(value: [dx, dy], cls: 'gravity')\n\n      objects = [].concat(parent.children, parent.controls)\n      q = d3.geom.quadtree(objects)\n\n      for node in objects\n        nx1 = node.x - node.w - 100\n        nx2 = node.x + node.w + 100\n        ny1 = node.y - node.h - 100\n        ny2 = node.y + node.h + 100\n\n        collide = (quad, x1, y1, x2, y2) =>\n          other = quad.point\n          if other and (other != node)\n            dx = node.x - other.x\n            dy = node.y - other.y\n            w = (node.w + other.w) / 2 + MARGIN\n            h = (node.h + other.h) / 2 + MARGIN\n\n            cx = w - Math.abs(dx)\n            cy = h - Math.abs(dy)\n            if cx > 0 and cy > 0\n              na = node.w * node.h\n              oa = other.w * other.h\n              f = oa / (oa + na)\n\n              if cx/w < cy/h\n                dy1 = dy2 = 0\n                s = if dx > 0 then 1 else -1\n                dx1 = s * f * cx\n                dx2 = s * (f-1) * cx\n\n              else\n                dx1 = dx2 = 0\n                s = if dy > 0 then 1 else -1\n                dy1 = s * f * cy\n                dy2 = s * (f-1) * cy\n\n              move(node, dx1, dy1)\n              move(other, dx2, dy2)\n              def(tick.forces, node.id, []).push(value: [dx1, dy1], cls: 'collision')\n              def(tick.forces, other.id, []).push(value: [dx2, dy2], cls: 'collision')\n\n          return x1 > nx2 or x2 < nx1 or y1 > ny2 or y2 < ny1\n\n        q.visit(collide)\n\n\n    adjustNode = (node) =>\n      if node.children.length > 0\n        handleCollisions(node, node, tick)\n\n        contents = [].concat(node.children, node.controls)\n        xMin = d3.min(contents, (d) -> d.x - d.w / 2) - CELL_PAD.left\n        xMax = d3.max(contents, (d) -> d.x + d.w / 2) + CELL_PAD.right\n        yMin = d3.min(contents, (d) -> d.y - d.h / 2) - CELL_PAD.top\n        yMax = d3.max(contents, (d) -> d.y + d.h / 2) + CELL_PAD.bottom\n        grow = node.textWidth - (xMax - xMin)\n        if grow > 0\n          xMin -= grow / 2\n          xMax += grow / 2\n        node.w = xMax - xMin\n        node.h = yMax - yMin\n        dx = xMin + node.w / 2 - node.x\n        dy = yMin + node.h / 2 - node.y\n        node.x += dx\n        node.y += dy\n        if node.fixed\n          move(node, -dx, -dy)\n\n      node.weight = node.w * node.h\n\n    for node in @s.top.children\n      walk(node, adjustNode, null, true)\n\n    handleCollisions(@s.top, {x: 0, y: 0}, tick)\n\n    if @debug\n      @container.selectAll('.cell .force').remove()\n\n      @container.selectAll('.cell')\n          .each (node) ->\n            for force in tick.forces.get(node.id) or []\n              d3.select(@).append('line')\n                  .attr('class', \"force #{force.cls}\")\n                  .attr('x1', 0)\n                  .attr('y1', 0)\n                  .attr('x2', force.value[0] * DEBUG_FORCE_FACTOR)\n                  .attr('y2', force.value[1] * DEBUG_FORCE_FACTOR)\n\n  start: ->\n    @runSimulation = true\n    @layout.start() if @layout?\n\n  stop: ->\n    @runSimulation = false\n    @layout.stop() if @layout?\n\n  highlightState: (id, highlight=true) ->\n    @queue.push (cb) =>\n      d3.select(@s.dom.get(\"cell-#{id}\"))\n          .classed('highlight', highlight)\n      cb()\n\n  highlightTransition: (source, target, highlight=true) ->\n    @queue.push (cb) =>\n      if (tr = findTransition(@s.transitions, source, target))?\n        d3.select(@s.dom.get(\"transition-#{tr.id}\"))\n            .classed('highlight', highlight)\n      cb()\n\n\nforce.render = (options) ->\n  return new force.Layout(options)\n"]}