{"version":3,"sources":["layout.coffee"],"names":[],"mappings":"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","file":"forceLayout.js","sourceRoot":"/source/","sourcesContent":["force = window.forceLayout = {}\n\nKIELER_URL = 'http://kieler.herokuapp.com/live'\nMARGIN = 5\nROUND_CORNER = 5\nCELL_MIN = {w: 40, h: 40}\nCELL_PAD = {top: 20, bottom: 5, left: 5, right: 5}\nEXPORT_PAD = {top: 10, bottom: 10, left: 10, right: 10}\nLABEL_SPACE = 400\nCONTROL_SIZE = {w: 25, h: 25}\nLINK_STRENGTH = .1\nLINK_DISTANCE = 30\nDEBUG_FORCE_FACTOR = 50\nMIN_ZOOM = 1/6\nMAX_ZOOM = 6\nANIMATION_SPEED = 2\nGEOMETRY_VERSION = 2\n\n\nstrip = (obj) ->\n  for key, value of obj\n    if value?\n      if _.isArray(value) and value.length == 0\n        delete obj[key]\n      else if _.isObject(value)\n        strip(value)\n        if _.isEmpty(value)\n          delete obj[key]\n    else\n      delete obj[key]\n  return obj\n\n\ntreeFromXml = (doc) ->\n  parseActions = (container) ->\n    rv = []\n    for child in container.childNodes\n      if child.tagName\n        rv.push(xml: '' + child)\n    return rv\n\n  parseChildNodes = (node) ->\n    transitions = []\n    onentry = []\n    onexit = []\n\n    for child in node.childNodes\n      switch child.tagName\n        when 'transition'\n          target = child.getAttribute('target')\n          if target and target.indexOf(' ') > -1\n            throw new Error(\"not implemented: transition with multiple targets\")\n          unless target\n            target = node.getAttribute('id')\n          transitions.push(strip(\n            target: target\n            cond: child.getAttribute('cond') or null\n            event: child.getAttribute('event') or null\n            actions: parseActions(child)\n          ))\n\n        when 'onentry'\n          onentry = onentry.concat(parseActions(child))\n\n        when 'onexit'\n          onexit = onexit.concat(parseActions(child))\n\n    return {\n      transitions: transitions\n      onentry: onentry\n      onexit: onexit\n    }\n\n  parseStates = (node) ->\n    stateList = []\n    for node in node.childNodes\n      state = switch node.tagName\n        when 'initial'\n          {\n            type: 'initial'\n            id: node.getAttribute('id') or null\n            children: parseStates(node)\n          }\n\n        when 'state'\n          {\n            type: 'state'\n            id: node.getAttribute('id') or null\n            children: parseStates(node)\n          }\n\n        when 'final'\n          {\n            type: 'final'\n            id: node.getAttribute('id') or null\n            children: parseStates(node)\n          }\n\n        when 'parallel'\n          {\n            type: 'parallel'\n            id: node.getAttribute('id') or null\n            children: parseStates(node)\n          }\n\n        when 'history'\n          {\n            type: 'history'\n            id: node.getAttribute('id') or null\n            deep: node.getAttribute('type') == 'deep' or null\n          }\n\n      if state?\n        _.extend(state, parseChildNodes(node))\n        stateList.push(strip(state))\n\n    return stateList\n\n  return {sc: parseStates(doc.documentElement)}\n\n\nidMaker = ->\n  counterMap = d3.map()\n  return (prefix='_force_id_') ->\n    counter = counterMap.get(prefix) or 0\n    counter += 1\n    counterMap.set(prefix, counter)\n    return \"#{prefix}#{counter}\"\n\n\nnextId = idMaker()\n\n\nwalk = (node, callback, parent=null, postorder=false) ->\n  callback(node, parent) unless postorder\n  for child in node.children or []\n    walk(child, callback, node, postorder)\n  callback(node, parent) if postorder\n\n\nparents = (node) ->\n  if node.parent then parents(node.parent).concat([node.parent]) else []\n\n\npath = (node1, node2) ->\n  parents1 = parents(node1)\n  parents2 = parents(node2)\n  eq = 0\n  for n in [0 .. d3.min([parents1.length, parents2.length]) - 1]\n    if parents1[n] != parents2[n] then break\n    eq = n\n  return [node1, parents1[eq], node2]\n\n\nmidpoint = (a, b) -> {\n  x: ((a.x or 0) + (b.x or 0)) / 2\n  y: ((a.y or 0) + (b.y or 0)) / 2\n}\n\n\nfindTransition = (transitions, source, target) ->\n  for tr in transitions\n    if tr.a.id == source and tr.b.id == target\n      return tr\n\n\nenvelope = (node, pad={}) ->\n  contents = [].concat(node.children, node.controls)\n  xMin = d3.min(contents, (d) -> d.x - d.w / 2) - (pad.left or 0)\n  xMax = d3.max(contents, (d) -> d.x + d.w / 2) + (pad.right or 0)\n  yMin = d3.min(contents, (d) -> d.y - d.h / 2) - (pad.top or 0)\n  yMax = d3.max(contents, (d) -> d.y + d.h / 2) + (pad.bottom or 0)\n  return [xMin, xMax, yMin, yMax]\n\n\ntoKielerFormat = (node) ->\n  children = []\n  edges = []\n  for child in node.children or []\n    children.push(toKielerFormat(child))\n  for transition in node.controls or []\n    children.push(\n      id: transition.id\n      desmTransition: true\n      width: transition.textWidth\n      height: 25\n    )\n    edges.push(\n      id: \"#{transition.id}#1\"\n      source: transition.a.id\n      target: transition.id\n    )\n    edges.push(\n      id: \"#{transition.id}#2\"\n      source: transition.id\n      target: transition.b.id\n    )\n  rv = {\n    id: node.id\n    children: children\n    edges: edges\n  }\n  if (node.children or []).length == 0\n    rv.width = node.w\n    rv.height = node.h\n  else if node.id != '__ROOT__'\n    rv.padding = {top: 15}\n  return rv\n\n\nforce.kielerLayout = (s, options) ->\n  top = s.top\n  kNodeMap = d3.map()\n  kEdgeMap = d3.map()\n  offsetMap = d3.map()\n\n  applyLayout = (kNode) ->\n    node = s.nodeMap.get(kNode.id)\n    return if node.desmTransition\n\n    offset = offsetMap.get(kNode.id)\n    if kNode.id != '__ROOT__'\n      node.w = kNode.width\n      node.h = kNode.height\n      node.x = offset.x + (kNode.x or 0) + node.w/2\n      node.y = offset.y + (kNode.y or 0) + node.h/2\n\n    for tr in node.transitions or []\n      x0 = offset.x\n      y0 = offset.y\n      kTr = kNodeMap.get(tr.id)\n      tr.x = x0 + kTr.x + kTr.width/2\n      tr.y = y0 + kTr.y + kTr.height/2 - 10\n\n      e1 = kEdgeMap.get(\"#{tr.id}#1\")\n      e2 = kEdgeMap.get(\"#{tr.id}#2\")\n\n      translate = (d) -> [x0 + d.x, y0 + d.y]\n\n      tr.route = {\n        src: translate(e1.sourcePoint)\n        segment1: (e1.bendPoints or []).map(translate)\n        label1: translate(e1.targetPoint)\n        label2: translate(e2.sourcePoint)\n        segment2: (e2.bendPoints or []).map(translate)\n        dst: translate(e2.targetPoint)\n      }\n\n    for kChild in kNode.children or []\n      applyLayout(kChild)\n\n  graph = toKielerFormat(top)\n\n  if options.algorithm == '__klayjs'\n    klay_ready = Q.defer()\n    $klay.layout(\n      graph: graph\n      options:\n        layoutHierarchy: true\n        edgeRouting: 'ORTHOGONAL'\n      success: klay_ready.resolve\n      error: (err) -> klay_ready.reject(new Error(err.text))\n    )\n\n    layoutDone = klay_ready.promise\n\n  else\n    form = {\n      graph: JSON.stringify(graph)\n      config: JSON.stringify(\n        algorithm: options.algorithm\n        edgeRouting: 'ORTHOGONAL'\n        layoutHierarchy: true\n      )\n      iFormat: 'org.json'\n      oFormat: 'org.json'\n    }\n\n    layoutDone = Q($.post(KIELER_URL, form))\n      .catch (resp) ->\n        throw Error(resp.responseText)\n      .then (resp) ->\n        return JSON.parse(resp)[0]\n\n  return layoutDone\n    .then (graphLayout) ->\n      offsetMap.set('__ROOT__', {\n        x: -graphLayout.width / 2\n        y: -graphLayout.height / 2\n      })\n      walk graphLayout, (kNode) =>\n        kNodeMap.set(kNode.id, kNode)\n        offset = offsetMap.get(kNode.id)\n        padding = _.extend({top: 0, left: 0}, kNode.padding)\n        for kChild in kNode.children or []\n          offsetMap.set(kChild.id, {\n            x: offset.x + (kNode.x or 0) + (padding.left or 0)\n            y: offset.y + (kNode.y or 0) + (padding.top or 0)\n          })\n        for kEdge in kNode.edges or []\n          kEdgeMap.set(kEdge.id, kEdge)\n      applyLayout(graphLayout)\n\n\nclass NewNodesAnimation\n\n  constructor: (@newNodes) ->\n    @deferred = Q.defer()\n    @promise = @deferred.promise\n    @done = no\n    @targetMap = d3.map()\n    @abort() unless @newNodes.length > 0\n\n    for node in @newNodes\n      @targetMap.set(node.id, {w: node.w, h: node.h})\n      node.w = node.h = 5\n\n  tick: ->\n    return if @done\n    changed = no\n    for node in @newNodes\n      target = @targetMap.get(node.id)\n      (node.w += ANIMATION_SPEED; changed = yes) if node.w < target.w\n      (node.h += ANIMATION_SPEED; changed = yes) if node.h < target.h\n\n    @abort() unless changed\n\n  abort: ->\n    @done = yes\n    @deferred.resolve()\n\n\nclass LoadingOverlay\n\n  constructor: (options) ->\n    w = $(options.svg).width()\n    h = $(options.svg).height()\n    @el = d3.select(options.svg).append('g')\n        .attr('class', \"loadingOverlay\")\n    @el.append('rect')\n        .attr('width', w)\n        .attr('height', h)\n    @el.append('text')\n        .attr('x', w/2)\n        .attr('y', h/2)\n        .text(options.text)\n\n  destroy: ->\n    @el.remove()\n\n\nclass force.Layout\n\n  constructor: (options) ->\n    @id = nextId()\n    @queue = async.queue(((task, cb) -> task(cb)), 1)\n    @options = options\n    @debug = options.debug or false\n    @svgCreate(options.parent)\n    @s = @_emptyState()\n    @animation = new NewNodesAnimation([])\n    @_initialTree(options.tree or treeFromXml(options.doc).sc)\n\n  _initialTree: (tree) ->\n    deferred = Q.defer()\n    @initialized = deferred.promise\n\n    @queue.push (cb) =>\n      try\n        @loadTree(tree)\n\n        if @options.geometry?\n          @applyGeometry(@options.geometry)\n          @beginSimulation()\n          cb()\n          deferred.resolve()\n\n        else\n          loading = new LoadingOverlay(svg: @el, text: \"Loading Kieler layout ...\")\n          deferred.resolve(\n            force.kielerLayout(@s, {\n              algorithm: @options.kielerAlgorithm\n            })\n              .then (treeWithLayout) =>\n                loading.destroy()\n                @beginSimulation()\n                cb()\n          )\n\n      catch e\n        deferred.reject(e)\n        cb()\n\n  update: (doc) ->\n    deferred = Q.defer()\n    @queue.push (cb) =>\n      deferred.resolve(\n        Q()\n        .then =>\n          @loadTree(treeFromXml(doc).sc)\n        .then =>\n          @beginSimulation()\n          @s.newNodes = []\n        .then =>\n          @animation = new NewNodesAnimation(@s.newNodes)\n          return @animation.promise\n        .catch (e) =>\n          console.error e\n        .finally =>\n          cb()\n      )\n\n    return deferred.promise\n\n  _emptyState: ->\n    s = {\n      nodes: []\n      cells: []\n      nodeMap: d3.map()\n      links: []\n      transitions: []\n      top: {\n        id: '__ROOT__'\n        children: []\n        controls: []\n      }\n      newNodes: []\n      dom: d3.map()\n    }\n    s.nodeMap.set(s.top.id, s.top)\n    return s\n\n  loadTree: (tree) ->\n    @mergeTree(tree)\n    @svgNodes()\n\n  beginSimulation: ->\n    @setupD3Layout()\n    @svgUpdate()\n\n  mergeTree: (tree) ->\n    oldS = @s\n    newS = @_emptyState()\n    newS.top.children = tree\n\n    makeId = idMaker()\n\n    for topNode in tree\n      walk topNode, (node, parent) =>\n        if node.id\n          node.label = node.id\n        else\n          node.id = makeId(\"_node_\")\n          node.label = \"<#{node.type}>\"\n        node.controls = []\n        node.children = node.children or []\n        if (oldNode = oldS.nodeMap.get(node.id))?\n          node.x = oldNode.x\n          node.y = oldNode.y\n          node.w = oldNode.w\n          node.h = oldNode.h\n        else\n          node.w = CELL_MIN.w\n          node.h = CELL_MIN.h\n          if parent?\n            node.x = parent.x\n            node.y = parent.y\n          newS.newNodes.push(node)\n        newS.nodes.push(node)\n        newS.cells.push(node)\n        newS.nodeMap.set(node.id, node)\n        node.parent = if parent? then newS.nodeMap.get(parent.id) else newS.top\n\n    for topNode in tree\n      walk topNode, (node) =>\n        for tr in node.transitions or []\n          unless (target = newS.nodeMap.get(tr.target))?\n            throw Error(\"missing transition target: #{tr.target}\")\n          [a, c, b] = path(node, target)\n          tr.parent = c or newS.top\n          tr.w = CONTROL_SIZE.w\n          tr.h = CONTROL_SIZE.h\n          tr.id = tr.id or makeId(\"_transition/#{node.id}/#{target.id}/\")\n          newS.nodeMap.set(tr.id, tr)\n          tr.parent.controls.push(tr)\n          newS.nodes.push(tr)\n          for [link_source, link_target] in d3.pairs([a, tr, b])\n            newS.links.push(\n              source: link_source\n              target: link_target\n            )\n          label = tr.event or ''\n          tr.a = a\n          tr.b = b\n          tr.selfie = node.id == tr.target\n          tr.label = label\n          newS.transitions.push(tr)\n          if (oldTr = findTransition(oldS.transitions, tr.a.id, tr.b.id))?\n            _.extend(tr, {x: oldTr.x, y: oldTr.y})\n          else\n            _.extend(tr, midpoint(tr.a, tr.b))\n\n    @s = newS\n\n  saveGeometry: ->\n    round = (x) -> Math.round(x)\n    return JSON.stringify({\n      nodes: {\n        id: n.id\n        w: round(n.w)\n        h: round(n.h)\n        x: round(n.x)\n        y: round(n.y)\n      } for n in @s.nodes\n      transitions: {\n        id: tr.id\n        route: tr.route\n      } for tr in @s.transitions\n      version: GEOMETRY_VERSION\n    })\n\n  applyGeometry: (geom_json) ->\n    geom = JSON.parse(geom_json)\n    return if geom.version != GEOMETRY_VERSION\n    for saved in geom.nodes\n      if (node = @s.nodeMap.get(saved.id))?\n        node.w = saved.w\n        node.h = saved.h\n    for saved in geom.transitions or []\n      if (tr = @s.nodeMap.get(saved.id))?\n        tr.route = saved.route\n    @svgUpdate()\n\n  svgCreate: (parent) ->\n    @zoomBehavior = d3.behavior.zoom()\n        .scaleExtent([MIN_ZOOM, MAX_ZOOM])\n\n    svg = d3.select(parent).append('svg')\n        .attr('xmlns:xmlns:xlink', 'http://www.w3.org/1999/xlink')\n        .classed('force-layout', true)\n        .classed('debug', @debug)\n    @el = svg[0][0]\n    defs = svg.append('defs')\n    @zoomNode = svg.append('g').call(@zoomBehavior)\n    @container = @zoomNode.append('g')\n\n    @container.append('rect')\n        .attr('class', 'zoomRect')\n\n    @zoomBehavior.on 'zoom', =>\n        e = d3.event\n        @container.attr('transform', \"translate(#{e.translate}),scale(#{e.scale})\")\n\n    defs.append('marker')\n        .attr('id', \"#{@id}-arrow\")\n        .attr('refX', '7')\n        .attr('refY', '5')\n        .attr('markerWidth', '10')\n        .attr('markerHeight', '10')\n        .attr('orient', 'auto')\n      .append('path')\n        .attr('d', 'M 0 0 L 10 5 L 0 10 z')\n        .attr('class', 'arrow')\n\n    @invalidateSize()\n\n  invalidateSize: ->\n    $parent = $(@el).parent()\n    width = $parent.width() - 5\n    height = $parent.height() - 5\n\n    d3.select(@el)\n        .attr('width', width)\n        .attr('height', height)\n\n    @container.select('.zoomRect')\n        .attr('width', width / MIN_ZOOM)\n        .attr('height', height / MIN_ZOOM)\n        .attr('x', - width / 2 / MIN_ZOOM)\n        .attr('y', - height / 2 / MIN_ZOOM)\n\n    @zoomBehavior\n        .size([width, height])\n        .translate([width / 2, height / 2])\n\n    @zoomBehavior.event(@zoomNode)\n\n  svgNodes: ->\n    @container.selectAll('.cell').remove()\n    @container.selectAll('.transition').remove()\n    @container.selectAll('.transition-label').remove()\n\n    cell = @container.selectAll('.cell')\n        .data(@s.cells)\n      .enter().append('g')\n        .attr('class', (cell) -> \"cell cell-#{cell.type or 'state'} draggable\")\n        .classed('parallel-child', (cell) -> cell.parent.type == 'parallel')\n\n    cell.append('rect')\n        .attr('class', 'border')\n        .attr('rx', ROUND_CORNER)\n        .attr('ry', ROUND_CORNER)\n\n    cell.append('text')\n        .text((node) -> node.label)\n        .each (node) ->\n          node.textWidth = d3.min([$(@).width() + 2 * ROUND_CORNER, LABEL_SPACE])\n          node.w = d3.max([node.w, node.textWidth])\n\n    @container.selectAll('.transition')\n        .data(@s.transitions)\n      .enter().append('g')\n        .attr('class', 'transition')\n      .append('path')\n        .attr('style', \"marker-end: url(##{@id}-arrow)\")\n        .attr('id', (tr) => \"#{@id}-transition/#{tr.id}\")\n\n    transitionLabel = @container.selectAll('.transition-label')\n        .data(@s.transitions)\n      .enter().append('g')\n        .attr('class', 'transition-label draggable')\n\n    if @options.textOnPath\n      transitionLabel.append('text')\n        .append('textPath')\n          .attr('xlink:href', (tr) => \"##{@id}-transition/#{tr.id}\")\n          .attr('startOffset', '50%')\n          .text((tr) -> tr.label)\n\n    else\n      transitionLabel.append('text')\n        .text((tr) -> tr.label)\n        .each (tr) ->\n          tr.textWidth = d3.min([$(@).width() + 5, LABEL_SPACE])\n          tr.w = d3.max([tr.w, tr.textWidth])\n        .attr('dy', '.3em')\n\n      transitionLabel.append('rect')\n          .attr('x', (tr) -> -tr.w / 2)\n          .attr('y', (tr) -> -tr.h / 2)\n          .attr('width', (tr) -> tr.w)\n          .attr('height', (tr) -> tr.h)\n\n    dom = @s.dom\n\n    @container.selectAll('.cell')\n        .each (node) ->\n          dom.set(\"cell-#{node.id}\", @)\n\n    @container.selectAll('.transition')\n        .each (node) ->\n          dom.set(\"transition-#{node.id}\", @)\n\n  svgUpdate: ->\n    @container.selectAll('.cell')\n        .attr('transform', (node) -> \"translate(#{node.x},#{node.y})\")\n        .classed('fixed', (node) -> node.fixed)\n\n    @container.selectAll('.cell').each (node) ->\n        d3.select(this).select('rect')\n            .attr('x', - node.w / 2)\n            .attr('y', - node.h / 2)\n            .attr('width', node.w)\n            .attr('height', node.h)\n\n        d3.select(this).select('text')\n            .attr('y', (node) -> CELL_PAD.top - node.h / 2 - 5)\n\n    @container.selectAll('.selfie').remove()\n\n    @container.selectAll('.transition').selectAll('path')\n        .attr 'd', (tr) ->\n          d3.svg.line()([].concat(\n            [tr.route.src]\n            tr.route.segment1\n            [tr.route.label1]\n            [tr.route.label2]\n            tr.route.segment2\n            [tr.route.dst]\n          ))\n\n    unless @options.textOnPath\n      @container.selectAll('.transition-label')\n          .attr('transform', (tr) -> \"translate(#{tr.x},#{tr.y})\")\n\n  setupD3Layout: ->\n    lock = {node: null, drag: false}\n\n    drag = d3.behavior.drag()\n        .origin((node) -> node)\n        .on 'dragstart', (node) =>\n          d3.event.sourceEvent.stopPropagation()\n          (lock.node = node).fixed = true\n          lock.drag = true\n        .on 'drag', (node) =>\n          d3.event.sourceEvent.stopPropagation()\n          @moveNode(node, d3.event.dx, d3.event.dy)\n          @adjustLayout()\n          @svgUpdate()\n        .on 'dragend', (node) =>\n          d3.event.sourceEvent.stopPropagation()\n          lock.drag = false\n          lock.node = null\n          node.fixed = false\n\n    @container.selectAll('.draggable')\n        .on 'mouseover', (node) =>\n          if lock.drag then return\n          if lock.node then lock.node.fixed = false\n          (lock.node = node).fixed = true\n          @svgUpdate()\n        .on 'mouseout', (node) =>\n          if lock.drag then return\n          lock.node = null\n          node.fixed = false\n          @svgUpdate()\n        .call(drag)\n\n  moveNode: (node, dx, dy) ->\n    node.x += dx\n    node.y += dy\n\n    translate = (p, dx, dy) -> p[0] += dx; p[1] += dy\n\n    if node.route?\n      translate(node.route.label1, dx, dy)\n      translate(node.route.label2, dx, dy)\n\n    else\n      for tr in @s.transitions\n        if tr.a.id == node.id\n          translate(tr.route.src, dx, dy)\n        if tr.b.id == node.id\n          translate(tr.route.dst, dx, dy)\n\n    for child in node.children or []\n      @moveNode(child, dx, dy)\n    for control in node.controls or []\n      @moveNode(control, dx, dy)\n\n  adjustLayout: ->\n    handleCollisions = (parent, center) =>\n      objects = [].concat(parent.children, parent.controls)\n      q = d3.geom.quadtree(objects)\n\n      for node in objects\n        nx1 = node.x - node.w - 100\n        nx2 = node.x + node.w + 100\n        ny1 = node.y - node.h - 100\n        ny2 = node.y + node.h + 100\n\n        collide = (quad, x1, y1, x2, y2) =>\n          other = quad.point\n          if other and (other != node)\n            dx = node.x - other.x\n            dy = node.y - other.y\n            w = (node.w + other.w) / 2 + MARGIN\n            h = (node.h + other.h) / 2 + MARGIN\n\n            cx = w - Math.abs(dx)\n            cy = h - Math.abs(dy)\n            if cx > 0 and cy > 0\n              na = node.w * node.h\n              oa = other.w * other.h\n              f = oa / (oa + na)\n\n              if cx/w < cy/h\n                dy1 = dy2 = 0\n                s = if dx > 0 then 1 else -1\n                dx1 = s * f * cx\n                dx2 = s * (f-1) * cx\n\n              else\n                dx1 = dx2 = 0\n                s = if dy > 0 then 1 else -1\n                dy1 = s * f * cy\n                dy2 = s * (f-1) * cy\n\n              @moveNode(node, dx1, dy1)\n              @moveNode(other, dx2, dy2)\n\n          return x1 > nx2 or x2 < nx1 or y1 > ny2 or y2 < ny1\n\n        q.visit(collide)\n\n\n    adjustNode = (node) =>\n      if node.children.length > 0\n        handleCollisions(node, node)\n        [xMin, xMax, yMin, yMax] = envelope(node, CELL_PAD)\n        grow = node.textWidth - (xMax - xMin)\n        if grow > 0\n          xMin -= grow / 2\n          xMax += grow / 2\n        node.w = xMax - xMin\n        node.h = yMax - yMin\n        dx = xMin + node.w / 2 - node.x\n        dy = yMin + node.h / 2 - node.y\n        node.x += dx\n        node.y += dy\n        if node.fixed\n          @moveNode(node, -dx, -dy)\n\n      node.weight = node.w * node.h\n\n    for node in @s.top.children\n      walk(node, adjustNode, null, true)\n\n    handleCollisions(@s.top, {x: 0, y: 0})\n\n  highlightState: (id, highlight=true) ->\n    @queue.push (cb) =>\n      d3.select(@s.dom.get(\"cell-#{id}\"))\n          .classed('highlight', highlight)\n      cb()\n\n  highlightTransition: (source, target, highlight=true) ->\n    @queue.push (cb) =>\n      if (tr = findTransition(@s.transitions, source, target))?\n        d3.select(@s.dom.get(\"transition-#{tr.id}\"))\n            .classed('highlight', highlight)\n      cb()\n\n  exportSvg: (options) ->\n    [xMin, xMax, yMin, yMax] = envelope(@s.top, EXPORT_PAD)\n    div = $('<div style=\"positoin:relative\">')[0]\n    svg = d3.select(div).append('svg')\n        .attr('xmlns', 'http://www.w3.org/2000/svg')\n        .attr('viewBox', \"#{xMin} #{yMin} #{xMax - xMin} #{yMax - yMin}\")\n        .classed('force-layout', true)\n    svg.append('defs')\n        .html(d3.select(@el).select('defs').html())\n        .append('style')\n          .html(options.css)\n    svg.append('g')\n        .html(@container.html())\n    $(div).find('.zoomRect').remove()\n    return div.innerHTML\n\nforce.render = (options) ->\n  return new force.Layout(options)\n"]}